<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Viewers en Vivo - Kick</title>
  <style>
    body {
      background-color: #0e0e0e;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      padding: 30px;
    }
    .widget-container {
      background-color: #1f1f1f;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 15px #00ff88;
      text-align: center;
      width: 420px;
    }
    .channel-name {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
      color: #00ff88;
    }
    iframe {
      border: none;
      width: 400px;
      height: 100px;
    }
    h2 {
      width: 100%;
      text-align: center;
      color: #00ff88;
      font-size: 28px;
    }
  </style>
</head>
<body>
  <h2>👀 Viewers en vivo de canales Kick</h2>

  <div class="widget-container">
    <div class="channel-name">deftsulol</div>
    <iframe id="deftsulol" src="https://kicktools.app/kick_views/kick_views.html?kick=deftsulol&theme=original"></iframe>
  </div>

  <div class="widget-container">
    <div class="channel-name">talona1</div>
    <iframe id="talona1" src="https://kicktools.app/kick_views/kick_views.html?kick=talona1&theme=original"></iframe>
  </div>

  <div class="widget-container">
    <div class="channel-name">elflaco</div>
    <iframe id="elflaco" src="https://kicktools.app/kick_views/kick_views.html?kick=elflaco&theme=original"></iframe>
  </div>

  <div class="widget-container">
    <div class="channel-name">role7</div>
    <iframe id="role7" src="https://kicktools.app/kick_views/kick_views.html?kick=role7&theme=original"></iframe>
  </div>

    <div class="widget-container">
    <div class="channel-name">role7</div>
    <iframe id="desacatoo" src="https://kicktools.app/kick_views/kick_views.html?kick=role7&theme=original"></iframe>
  </div>

  <script>
    // Solicitar permiso de notificación
    if (Notification.permission !== 'granted') {
      Notification.requestPermission();
    }

    // Configura los valores mínimos por canal aquí
    const thresholds = {
      deftsulol: 148,
      talona1: 200,
      elflaco: 200,
      role7: 150
    };

    // Evita notificaciones repetidas
    const notified = {};

    // Extrae viewers de los iframes cada 10s
    setInterval(() => {
      Object.keys(thresholds).forEach(channel => {
        const iframe = document.getElementById(channel);
        try {
          const doc = iframe.contentDocument || iframe.contentWindow.document;
          const value = doc.body.textContent.match(/\d+/);
          if (value) {
            const viewers = parseInt(value[0]);
            if (viewers < thresholds[channel] && !notified[channel]) {
              new Notification(`⚠️ Canal ${channel}`, {
                body: `Viewers bajaron a ${viewers}`,
              });
              notified[channel] = true;
            }
            if (viewers >= thresholds[channel]) {
              notified[channel] = false;
            }
          }
        } catch (e) {
          // Acceso cross-origin: no hace nada
        }
      });
    }, 10000); // cada 10 segundos
  </script>
</body>
</html>
